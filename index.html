<!DOCTYPE html>
<html>
  <head>
    <script>
      document.addEventListener('DOMContentLoaded', function() {

        let subjectSelectors = document.querySelectorAll('.subject-selector');
        subjectSelectors.forEach(selector => {
          selector.addEventListener('change', function() {
            let html = '';
            subjectSelectors.forEach(selector => {
              if(selector.checked) {
                html += `
                  <div>
                    <input class="grade" id=${selector.id+'-grade'} type="number" max="10" min="0">
                    <label for=${selector.id+'-grade'}>${selector.name}</label>
                  </div>`;
              }
            });
            document.getElementById('input-set').innerHTML = html;
            updateInputs();
          });
        });

        function updateInputs()
        {
          let count = 0;
          let inputs = document.querySelectorAll('.grade');
          inputs.forEach(input => {
            count += 1;
            input.addEventListener('change', function() {
              let sum = 0;
              inputs.forEach(input => {
                sum += parseFloat(input.value) || 0;
              });

              let average = (sum/count);
              document.getElementById('results').innerHTML = `Nota final: ${average}`;
            });
          });
        }
      });
    </script>
  </head>
  <body>
    <h1>Calculador de Nota Media</h1>
    <fieldset>
      <legend>Elige tus asignaturas:</legend>
      
      <div>
        <input type="checkbox" class="subject-selector" id="mti" name="Matemáticas"/>
        <label for="mti">Matemáticas</label>
      </div>
      <div>
        <input type="checkbox" class="subject-selector" id="ley" name="Lengua"/>
        <label for="ley">Lengua</label>
      </div>
      <div>
        <input type="checkbox" class="subject-selector" id="fil" name="Filosofía"/>
        <label for="fil">Filosofía</label>
      </div>
      <div>
        <input type="checkbox" class="subject-selector" id="li1" name="Inglés"/>
        <label for="li1">Inglés</label>
      </div>

    </fieldset>

    <div id="input-set"></div>

    <p id="results"></p>
  </body>
</html>